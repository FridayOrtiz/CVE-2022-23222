# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure("2") do |config|
  config.vm.box = "generic/ubuntu2110" # intentionally use an EOL Ubuntu release
  config.vm.box_version = "3.5.0"      # intentionally use an old release of the box
  config.vm.synced_folder "../", "/exploit", type: "rsync",
    rsync__args: ["--verbose", "--rsync-path='sudo rsync'", "--archive", "--delete", "-z"]

  # We want to keep the older version, so we stay vulnerable.
  config.vm.box_check_update = false

  # Enable unprivileged BPF, for the exploit.
  config.vm.provision "shell", inline: <<-SHELL
    sysctl kernel.unprivileged_bpf_disabled=0
  SHELL
end
